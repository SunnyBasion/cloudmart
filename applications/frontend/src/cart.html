<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Shopping Cart</title>
  <style>
    body { font-family: Arial, sans-serif; background:#f4f4f4; margin:20px; }
    .item {
      background:white;
      padding:10px;
      margin:10px 0;
      border-radius:8px;
      box-shadow:0 2px 5px rgba(0,0,0,0.1);
    }
    button {
      margin-top:20px;
      padding:10px 20px;
      background:#28a745;
      color:white;
      border:none;
      border-radius:5px;
      cursor:pointer;
    }
  </style>
</head>
<body>

<h1>Your Cart</h1>
<div id="cart">Loading cart...</div>
<h2 id="total"></h2>

<button onclick="placeOrder()">Confirm Order</button>

<script>
  function loadCart() {
    fetch("/api/v1/cart")
      .then(r => r.json())
      .then(items => {
        const container = document.getElementById("cart");
        let total = 0;

        if (items.length === 0) {
          container.innerHTML = "<p>Your cart is empty!</p>";
          document.getElementById("total").innerText = "";
          return;
        }

        container.innerHTML = items.map(i => {
          total += (i.quantity || 1);
          return `<div class="item">
                    <p><strong>Product:</strong> ${i.product_id}</p>
                    <p><strong>Quantity:</strong> ${i.quantity}</p>
                  </div>`;
        }).join("");

        document.getElementById("total").innerText = "Total items: " + total;
      });
  }

  function placeOrder() {
    fetch("/api/v1/orders", { method: "POST" })
      .then(r => r.json())
      .then(order => {
        alert("Order Confirmed! Order ID: " + order.id);
        loadCart(); // Refresh UI after placing order
      });
  }

  loadCart();
</script>

</body>
</html>

